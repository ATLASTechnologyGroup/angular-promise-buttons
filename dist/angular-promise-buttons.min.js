angular.module("angularPromiseButtons",[]),angular.module("angularPromiseButtons").directive("promiseBtn",["angularPromiseButtons","$compile","$parse",function(a,b,c){"use strict";return{restrict:"EA",priority:a.config.priority,scope:{promiseBtn:"=",promiseBtnOptions:"=?"},link:function(d,e,f){function g(a){q.btnLoadingClass&&!q.addClassToCurrentBtnOnly&&a.addClass(q.btnLoadingClass),q.disableBtn&&!q.disableCurrentBtnOnly&&a.attr("disabled","disabled")}function h(a){q.btnLoadingClass&&a.removeClass(q.btnLoadingClass),q.disableBtn&&a.removeAttr("disabled")}function i(a,b){d.$watch(a,function(a){a&&a.then?(g(b),a.finally(function(){h(b)})):a&&a.$promise&&(g(b),a.$promise.finally(function(){h(b)}))})}function j(a){return a.split(";").map(function(a){return c(a)})}function k(a){a.append(b(q.spinnerTpl)(d))}function l(a){q.addClassToCurrentBtnOnly&&a.on(q.CLICK_EVENT,function(){a.addClass(q.btnLoadingClass)}),q.disableCurrentBtnOnly&&a.on(q.CLICK_EVENT,function(){a.attr("disabled","disabled")})}function m(a,b,c){d.$evalAsync(function(){var g=j(f[b]);e.unbind(a),e.bind(a,function(){d.$apply(function(){g.forEach(function(b){var e=b(d.$parent,{$event:a});o||(o=i(function(){return e},c))})})})})}function n(a){for(var b=[],c=a.find("button"),d=0;d<c.length;d++){var e=c[d];"submit"===angular.element(e).attr("type")&&b.push(e)}return angular.element(b)}var o,p=a.config,q=p;if(f.promiseBtn)k(e),l(e),i(function(){return d.promiseBtn},e);else if(f.hasOwnProperty(q.CLICK_ATTR))k(e),l(e),m(q.CLICK_EVENT,q.CLICK_ATTR,e);else if(f.hasOwnProperty(q.SUBMIT_ATTR)){var r=n(e);k(r),l(r),m(q.SUBMIT_EVENT,q.SUBMIT_ATTR,r)}d.$watch("promiseBtnOptions",function(a){angular.isObject(a)&&(q=angular.extend({},p,a))},!0)}}}]),angular.module("angularPromiseButtons").provider("angularPromiseButtons",function(){"use strict";var a={spinnerTpl:'<span class="btn-spinner"></span>',priority:0,disableBtn:!0,btnLoadingClass:"is-loading",addClassToCurrentBtnOnly:!1,disableCurrentBtnOnly:!1,CLICK_EVENT:"click",CLICK_ATTR:"ngClick",SUBMIT_EVENT:"submit",SUBMIT_ATTR:"ngSubmit"};return{extendConfig:function(b){a=angular.extend(a,b)},$get:function(){return{config:a}}}});